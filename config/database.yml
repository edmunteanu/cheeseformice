# Reusable configurations
default: &default
  adapter: postgresql
  encoding: unicode
  pool: <%= ENV.fetch("RAILS_MAX_THREADS", 3) %>
a801: &a801
  adapter: mysql2
  encoding: utf8mb4
  pool: <%= ENV.fetch("RAILS_MAX_THREADS", 3) %>
  host: <%= Rails.application.credentials.dig(:a801_database, :host) %>
  port: <%= Rails.application.credentials.dig(:a801_database, :port) %>
  database: <%= Rails.application.credentials.dig(:a801_database, :name) %>
  username: <%= Rails.application.credentials.dig(:a801_database, :username) %>
  password: <%= Rails.application.credentials.dig(:a801_database, :password) %>
  database_tasks: false
  # connect_timeout is deliberately left empty to force the mysql2 adapter to use nil as the timeout. For more
  # information, refer to https://devcenter.heroku.com/articles/quotaguardstatic#setting-up-mysql-access-from-rails
  connect_timeout:

# Development-specific configuration. Offers both a primary and an a801 database configuration.
development:
  primary:
    <<: *default
    database: cheeseformice_development
  a801:
    <<: *a801

# Test-specific configuration. Only offers a primary database configuration.
test:
  primary:
    <<: *default
    database: cheeseformice_test

# Production-specific configuration. Offers both a primary and an a801 database configuration.
production:
  primary:
    <<: *default
    url: <%= Rails.application.credentials[:database_url] %>
  a801:
    <<: *a801
