#!/usr/bin/env bash
set -euo pipefail

echo 'Executing Zeitwerk check'
bin/rails zeitwerk:check

echo 'Executing rubocop'
if ! bundle exec rubocop -D -c .rubocop.yml --fail-fast
then
  echo 'Rubocop detected issues!'
  bundle exec rubocop -A -D -c .rubocop.yml

  echo 'Tried to auto correct the issues, but must be reviewed manually, commit aborted'
  exit 1
fi
